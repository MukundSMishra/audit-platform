# Submit for Review - System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AUDIT PLATFORM WORKFLOW                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Dashboard     â”‚
â”‚                 â”‚
â”‚ Select Client   â”‚
â”‚ Choose Acts     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Audit Screen   â”‚  â—„â”€â”€â”€ AuditCard.jsx (for each question)
â”‚                 â”‚
â”‚ Answer Q1-Qn    â”‚  â€¢ Applicability check
â”‚ Upload Evidence â”‚  â€¢ Compliance verdict
â”‚ Add Comments    â”‚  â€¢ Evidence upload
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â€¢ Auditor comments
         â”‚
         â”‚ (Auto-save progress to Supabase)
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ğŸ ALL QUESTIONS COMPLETE (Progress = 100%)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Click "Complete & Review" OR
         â”‚ Click "Submit for Review" from Progress Screen
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               SubmitForReview.jsx Component                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Display Summary:                                    â”‚   â”‚
â”‚  â”‚ â€¢ Total Questions: 120                              â”‚   â”‚
â”‚  â”‚ â€¢ Compliant: 95                                     â”‚   â”‚
â”‚  â”‚ â€¢ Non-Compliant: 15                                 â”‚   â”‚
â”‚  â”‚ â€¢ Delayed: 5                                        â”‚   â”‚
â”‚  â”‚ â€¢ Not Applicable: 5                                 â”‚   â”‚
â”‚  â”‚                                                     â”‚   â”‚
â”‚  â”‚ [Cancel] [Submit for AI Review â†’]                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â”‚ Click "Submit for AI Review"
                           â”‚
                           â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   Build Payload (submitForReview)   â”‚
         â”‚                                     â”‚
         â”‚  {                                  â”‚
         â”‚    batch_id: "uuid",                â”‚
         â”‚    session_id: "uuid",              â”‚
         â”‚    company_name: "...",             â”‚
         â”‚    location: "...",                 â”‚
         â”‚    audit_items: [                   â”‚
         â”‚      {                              â”‚
         â”‚        audit_item_id: "...",        â”‚
         â”‚        question_text: "...",        â”‚
         â”‚        legal_text: "...",           â”‚
         â”‚        risk_level: "...",           â”‚
         â”‚        workflow_type: "...",        â”‚
         â”‚        intern_verdict: "...",       â”‚
         â”‚        evidence_url: "...",         â”‚
         â”‚        ...                          â”‚
         â”‚      }                              â”‚
         â”‚    ]                                â”‚
         â”‚  }                                  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ POST Request
                        â”‚
                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Python AI Agent (http://127.0.0.1:8000)          â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
    â”‚                                                   â”‚
    â”‚  Endpoint: /submit-audit-batch                    â”‚
    â”‚                                                   â”‚
    â”‚  1. Validate Request Schema                       â”‚
    â”‚  2. Analyze Evidence (if ai_evidence workflow)    â”‚
    â”‚  3. Cross-check Legal Requirements                â”‚
    â”‚  4. Calculate Compliance Scores                   â”‚
    â”‚  5. Identify Critical Findings                    â”‚
    â”‚  6. Generate Recommendations                      â”‚
    â”‚                                                   â”‚
    â”‚  AI Processing:                                   â”‚
    â”‚  â€¢ OCR for document evidence                      â”‚
    â”‚  â€¢ Image recognition for photos                   â”‚
    â”‚  â€¢ NLP for text analysis                          â”‚
    â”‚  â€¢ Rule-based legal compliance checks             â”‚
    â”‚                                                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ Return JSON Report
                        â”‚
                        â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  AI Report Response:             â”‚
         â”‚  {                               â”‚
         â”‚    status: "success",            â”‚
         â”‚    batch_id: "...",              â”‚
         â”‚    overall_compliance: 85,       â”‚
         â”‚    critical_findings: 2,         â”‚
         â”‚    high_risk_findings: 5,        â”‚
         â”‚    recommendations: [...],       â”‚
         â”‚    summary: "...",               â”‚
         â”‚    processing_timestamp: "..."   â”‚
         â”‚  }                               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ onSubmitSuccess callback
                        â”‚
                        â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Save to Supabase: ai_review_reports          â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€      â”‚
    â”‚                                               â”‚
    â”‚  INSERT INTO ai_review_reports (              â”‚
    â”‚    batch_id,                                  â”‚
    â”‚    session_id,                                â”‚
    â”‚    report_data (JSONB)                        â”‚
    â”‚  )                                            â”‚
    â”‚                                               â”‚
    â”‚  UPDATE audit_sessions                        â”‚
    â”‚  SET status = 'Completed'                     â”‚
    â”‚  WHERE id = session_id                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ Success!
                        â”‚
                        â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Show Success Message        â”‚
         â”‚  â€¢ "Submitted successfully!" â”‚
         â”‚  â€¢ Wait 3 seconds            â”‚
         â”‚  â€¢ Auto-redirect             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Back to Dashboard           â”‚
         â”‚                              â”‚
         â”‚  â€¢ View completed audits     â”‚
         â”‚  â€¢ Access AI reports         â”‚
         â”‚  â€¢ Start new audits          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DATABASE TABLES INVOLVED:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ audit_sessions                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                  UUID (PK)                              â”‚
â”‚ factory_name        TEXT                                   â”‚
â”‚ location            TEXT                                   â”‚
â”‚ status              TEXT  â—„â”€â”€â”€ Updated to "Completed"      â”‚
â”‚ completed_at        TIMESTAMPTZ                            â”‚
â”‚ user_id             UUID (FK â†’ profiles)                   â”‚
â”‚ ...                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ references
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ session_answers                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ session_id          UUID (FK â†’ audit_sessions)            â”‚
â”‚ act_id              TEXT                                   â”‚
â”‚ question_id         TEXT                                   â”‚
â”‚ status              TEXT (Compliant/Non-Compliant/etc)     â”‚
â”‚ evidence_url        TEXT                                   â”‚
â”‚ remarks             TEXT                                   â”‚
â”‚ ...                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â”‚ used by submitForReview
                        â”‚
                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ai_review_reports (NEW TABLE)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id                  UUID (PK)                              â”‚
â”‚ batch_id            TEXT (UNIQUE)                          â”‚
â”‚ session_id          UUID (FK â†’ audit_sessions)            â”‚
â”‚ report_data         JSONB â—„â”€â”€â”€ AI Agent response stored   â”‚
â”‚ created_at          TIMESTAMPTZ                            â”‚
â”‚ updated_at          TIMESTAMPTZ                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COMPONENT HIERARCHY:

App.jsx
  â”‚
  â”œâ”€ Dashboard
  â”‚    â””â”€ Start Audit
  â”‚
  â”œâ”€ ActSelector
  â”‚    â””â”€ Choose Acts
  â”‚
  â”œâ”€ AuditProgress â—„â”€â”€â”€ NEW: "Submit for Review" button added
  â”‚    â””â”€ Continue/Review Audits
  â”‚
  â”œâ”€ Audit Screen
  â”‚    â”œâ”€ AuditCard (Q1)
  â”‚    â”œâ”€ AuditCard (Q2)
  â”‚    â””â”€ AuditCard (Qn)
  â”‚         â””â”€ "Complete & Review" button â—„â”€â”€â”€ Triggers submit
  â”‚
  â””â”€ SubmitForReview â—„â”€â”€â”€ NEW COMPONENT
       â”œâ”€ Display Summary Stats
       â”œâ”€ Build Payload
       â”œâ”€ POST to AI Agent
       â”œâ”€ Handle Response
       â””â”€ Save to Supabase


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STATE FLOW IN APP.JSX:

currentScreen: 'dashboard'
      â†“
currentScreen: 'audit-type'
      â†“
currentScreen: 'act-selector'
      â†“
currentScreen: 'audit'  (answering questions)
      â†“
      â”‚ (When last question completed)
      â”‚
      â–¼
currentScreen: 'submit-review' â—„â”€â”€â”€ NEW STATE
      â†“
      â”‚ (After successful submission)
      â”‚
      â–¼
currentScreen: 'dashboard'


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PAYLOAD EXAMPLE:

{
  "batch_id": "batch_abc123_1704067200000",
  "session_id": "550e8400-e29b-41d4-a716-446655440000",
  "company_name": "ABC Manufacturing Ltd",
  "location": "Mumbai, Maharashtra",
  "submitted_at": "2025-01-01T00:00:00.000Z",
  "audit_items": [
    {
      "audit_item_id": "factories_act_q1",
      "question_text": "Is fire safety equipment maintained?",
      "legal_text": "Section 38 of Factories Act requires...",
      "risk_level": "Critical",
      "category": "Fire Safety",
      "workflow_type": "manual_observation",
      "intern_verdict": "Compliant",
      "intern_comment": "Fire extinguishers checked monthly",
      "evidence_url": "https://storage.supabase.co/...",
      "applicability_reason": null,
      "is_applicable": true
    },
    {
      "audit_item_id": "factories_act_q2",
      "question_text": "Are safety training records maintained?",
      "legal_text": "Rule 98 requires quarterly training",
      "risk_level": "High",
      "category": "Training & Development",
      "workflow_type": "ai_evidence",
      "intern_evidence": "Training register uploaded",
      "evidence_url": "https://storage.supabase.co/...",
      "missing_evidence_reason": null,
      "is_applicable": true
    }
  ]
}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```
